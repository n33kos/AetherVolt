!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("PipeDream",[],t):"object"==typeof exports?exports.PipeDream=t():e.PipeDream=t()}(window,function(){return function(n){var i={};function a(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=n,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=11)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.x=e,this.y=t}return i(n,[{key:"toArray",value:function(){return[this.x,this.y]}}]),n}();t.default=a},function(e,t,n){"use strict";var o=n(16),s=n(17);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var r=0;r<16;++r)t[i+r]=a[r];return t||s(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=this.getTypeId(e),this.type=this.getTypeString(this.id),this.spriteSheet=this.getSpriteSheet(this.id),this.neighborPattern=this.getNeighborPattern(this.id)}return i(t,[{key:"getTypeId",value:function(e){return{EMPTY:1,PLAYER_COLUMN:2,STRAIGHT:3,BEND:4,TRIPLE:5,QUAD:6}[e]}},{key:"getTypeString",value:function(e){return{1:"EMPTY",2:"PLAYER_COLUMN",3:"STRAIGHT",4:"BEND",5:"TRIPLE",6:"QUAD"}[e]}},{key:"getSpriteSheet",value:function(e){return{1:"./img/Pipes_Empty.png",2:"./img/Pipes_Empty.png",3:"./img/Pipes_Straight.png",4:"./img/Pipes_Bend.png",5:"./img/Pipes_Triple.png",6:"./img/Pipes_Quad.png"}[e]}},{key:"getNeighborPattern",value:function(e){return{1:[],2:[0,1,2,3],3:[1,3],4:[0,1],5:[0,1,3],6:[0,1,2,3]}[e]}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=r(n(8));r(n(0));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e)),n=e.x,i=e.y,a=e.id,r=e.type,o=e.player,s=e.isInHand,u=void 0!==s&&s,l=e.isSelected,c=void 0!==l&&l,f=e.dragPosition,h=void 0===f?null:f;return t.x=n,t.y=i,t.id=a,t.tileType=r,t.player=o,t.isInHand=u,t.isSelected=c,t.dragPosition=h,t.animations={exist:{frames:8,spriteSheet:"./img/Pipes_Empty.png",ticksPerFrame:5,loop:!1}},t.currentAnimation="exist",t.neighborPattern=[],t.isHovered=!1,t.placedBy=!1,t.setType(r),t.calculateOffset(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,a.default),i(d,[{key:"setType",value:function(e){this.tileType=e,this.animations.exist.spriteSheet=e.spriteSheet,this.neighborPattern=e.neighborPattern,this.load()}},{key:"init",value:function(e){this.grid=e,this.neighbors=this.getNeighbors()}},{key:"getNeighbors",value:function(){var t=this,e=[];return this.grid?(this.neighborPattern.includes(0)&&e.push(this.grid.find(function(e){return e.id==t.x+1+"_"+t.y})),this.neighborPattern.includes(1)&&e.push(this.grid.find(function(e){return e.id==t.x+"_"+(t.y+1)})),this.neighborPattern.includes(2)&&e.push(this.grid.find(function(e){return e.id==t.x-1+"_"+t.y})),this.neighborPattern.includes(3)&&e.push(this.grid.find(function(e){return e.id==t.x+"_"+(t.y-1)})),e):[]}},{key:"rotateCell",value:function(t){var e=this.rotation+Math.PI/(2*t);e>=2*Math.PI&&(e=0),e<0&&(e=1.5*Math.PI),this.rotation=e,this.neighborPattern=this.neighborPattern.map(function(e){return(e+=t)<0&&(e=3),3<e&&(e=0),e}),this.neighbors=this.getNeighbors()}},{key:"draw",value:function(){(function e(t,n,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,i)}if("value"in a)return a.value;var o=a.get;return void 0!==o?o.call(i):void 0})(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"draw",this).call(this),this.drawOutline()}},{key:"setOutlineColor",value:function(){this.GameState.Canvas.ctx.strokeStyle="rgba(255, 255, 255, 0.2)","PLAYER_COLUMN"===this.tileType.type&&(this.GameState.Canvas.ctx.strokeStyle="rgba(0, 0, 0, 0)"),(this.isHovered||this.isInHand)&&(this.GameState.Canvas.ctx.strokeStyle=this.GameState.currentLevel.players[this.GameState.currentLevel.currentPlayerTurn].color),this.isSelected&&(this.GameState.Canvas.ctx.strokeStyle="pink"),this.placedBy&&(this.GameState.Canvas.ctx.strokeStyle=this.placedBy.color)}},{key:"drawOutline",value:function(){this.GameState.Canvas.ctx.beginPath(),this.GameState.Canvas.ctx.lineWidth=1*window.devicePixelRatio,this.setOutlineColor(),this.GameState.Canvas.ctx.rect(0,0,this.dimensions.x*this.scale.x,this.dimensions.y*this.scale.y),this.GameState.Canvas.ctx.stroke()}}]),d}();t.default=o},function(e,t,n){"use strict";function i(a,r,o,s){var u,l=0;return"boolean"!=typeof r&&(s=o,o=r,r=void 0),function(){var e=this,t=Number(new Date)-l,n=arguments;function i(){l=Number(new Date),o.apply(e,n)}s&&!u&&i(),u&&clearTimeout(u),void 0===s&&a<t?i():!0!==r&&(u=setTimeout(s?function(){u=void 0}:i,void 0===s?a-t:a))}}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=i,t.debounce=function(e,t,n){return void 0===n?i(e,t,!1):i(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(6),o=(i=r)&&i.__esModule?i:{default:i};var s=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.name="Default Level",t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,o.default),a(n,[{key:"gameLogic",value:function(){}}]),n}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function n(e){var t=e.GameState;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.GameState=t,this.audioNodes=[],this.controlCallbackIds=[]}return i(n,[{key:"load",value:function(){}},{key:"unload",value:function(){var t=this;this.audioNodes.forEach(function(e){e.stop(0)}),this.audioNodes=[],this.controlCallbackIds.forEach(function(e){t.GameState.Controls.removeCallback(e)}),this.controlCallbackIds=[]}},{key:"addControlsCallback",value:function(e,t){this.controlCallbackIds.push(this.GameState.Controls.addCallback(e,t))}},{key:"addAudioNode",value:function(e){this.audioNodes.push(e),e.load()}}]),n}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=this.getTypeId(e),this.type=this.getTypeString(this.id)}return i(t,[{key:"getTypeId",value:function(e){return{MOVE:1,PLACE:2,ROTATE:3}[e]}},{key:"getTypeString",value:function(e){return{1:"MOVE",2:"PLACE",3:"ROTATE"}[e]}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=r(n(9)),y=r(n(0));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e)),n=e.animations,i=e.currentFrame,a=void 0===i?0:i,r=e.currentAnimation,o=void 0===r?null:r,s=e.mirrorX,u=void 0!==s&&s,l=e.mirrorY,c=void 0!==l&&l,f=e.scale,h=void 0===f?new y.default(1,1):f;return t.animations=n,t.currentAnimation=o,t.currentFrame=a,t.scale=h,t.mirrorX=u,t.mirrorY=c,t.lastAnimation=null,t.tickCounter=0,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,a.default),i(d,[{key:"load",value:function(){var n=this;Object.keys(this.animations).forEach(function(e){var t=new Image;t.src=n.animations[e].spriteSheet,n.animations[e].image=t})}},{key:"calculateOffset",value:function(){this.scale&&(this.absoluteOffset=new y.default(-this.offset.x*this.dimensions.x*this.scale.x*(this.mirrorX?-1:1),-this.offset.y*this.dimensions.y*this.scale.y*(this.mirrorY?-1:1)))}},{key:"draw",value:function(){this.animations[this.currentAnimation]&&(this.handleFrames(),(this.mirrorX||this.mirrorY)&&this.GameState.Canvas.ctx.scale(this.mirrorX?-1:1,this.mirrorY?-1:1),this.GameState.Canvas.ctx.drawImage(this.animations[this.currentAnimation].image,this.currentFrame*this.dimensions.x,0,this.dimensions.x,this.dimensions.y,0,0,this.dimensions.x*this.scale.x,this.dimensions.y*this.scale.y))}},{key:"handleFrames",value:function(){this.tickCounter++,this.animations[this.currentAnimation].loop&&(this.incrementAnimationFrame(),this.currentFrame>=this.animations[this.currentAnimation].frames&&(this.currentFrame=0)),this.animations[this.currentAnimation].loop||(this.currentFrame>=this.animations[this.currentAnimation].frames-1?(this.tickCounter=0,this.currentFrame=this.animations[this.currentAnimation].frames-1):this.incrementAnimationFrame()),this.lastAnimation!==this.currentAnimation&&(this.lastAnimation=this.currentAnimation,this.currentFrame=0,this.tickCounter=0)}},{key:"incrementAnimationFrame",value:function(){this.tickCounter>this.animations[this.currentAnimation].ticksPerFrame&&(this.tickCounter=0,this.currentFrame+=1)}}]),d}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=o(n(6)),d=o(n(0)),r=o(n(24));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function h(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,e)),n=e.dimensions,i=void 0===n?new d.default(100,100):n,a=e.offset,r=void 0===a?new d.default(.5,.5):a,o=e.position,s=void 0===o?new d.default:o,u=e.rotation,l=void 0===u?0:u,c=e.alpha,f=void 0===c?1:c;return t.absoluteOffset=new d.default,t.audioNodes=[],t.canvasPosition=new d.default,t.controlCallbackIds=[],t.dimensions=i,t.GameState=GameState,t.offset=r,t.position=s,t.rotation=l,t.isVisible=!0,t.alpha=f,t.setPosition(s),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,a.default),i(h,[{key:"setPosition",value:function(e){this.position=e,this.canvasPosition=(0,r.default)(this.GameState,this.position),this.calculateOffset()}},{key:"calculateOffset",value:function(){this.absoluteOffset=new d.default(-this.offset.x*this.dimensions.x,-this.offset.y*this.dimensions.y)}},{key:"drawEntity",value:function(){this.isVisible&&(this.GameState.Canvas.ctx.translate(this.canvasPosition.x,this.canvasPosition.y),this.GameState.Canvas.ctx.rotate(this.rotation),this.GameState.Canvas.ctx.translate(this.absoluteOffset.x,this.absoluteOffset.y),this.GameState.Canvas.ctx.globalAlpha=this.alpha,this.draw(),this.GameState.Canvas.ctx.setTransform(1,0,0,1,0,0),this.GameState.Canvas.ctx.globalAlpha=1)}},{key:"update",value:function(){}},{key:"draw",value:function(){}}]),h}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Math.random()*(t-e)+e}},function(e,t,n){"use strict";var i=f(n(12)),a=f(n(13)),r=f(n(14)),o=f(n(18)),s=f(n(33)),u=f(n(34)),l=f(n(35)),c=f(n(36));function f(e){return e&&e.__esModule?e:{default:e}}var h={Audio:i.default,Canvas:a.default,Controls:r.default,GameState:o.default,Render:s.default,Scene:u.default,UI:l.default,Update:c.default};document.addEventListener("DOMContentLoaded",function(e){var t=new h.GameState;t.init(),(window.GameState=t).Audio=new h.Audio(t),t.Canvas=new h.Canvas(t),t.Canvas.init(),t.Controls=new h.Controls(t),t.Controls.init(),t.Scene=new h.Scene(t),t.Scene.init(),t.Render=new h.Render(t),t.Render.init(),t.Update=new h.Update(t),t.Update.init(),t.UI=new h.UI(t),t.UI.init()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.audioContext=null,this.masterAudioNode=null,this.isInitialized=!1}return i(t,[{key:"init",value:function(){var e=new(window.AudioContext||window.webkitAudioContext),t=(this.audioContext=e).createGain();t.gain.value=.75,t.connect(e.destination),this.masterAudioNode=t,this.isInitialized=!0}},{key:"toggleMute",value:function(){"running"===this.audioContext.state?this.audioContext.suspend():"suspended"===this.audioContext.state&&this.audioContext.resume()}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=n(4);var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.cx=null,this.cy=null,this.canvas=null,this.ctx=null,this.scale=1}return i(t,[{key:"init",value:function(){this.setDimensions(),this.initCanvas()}},{key:"setDimensions",value:function(){this.scale=window.devicePixelRatio,this.width=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)*this.scale,this.height=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)*this.scale}},{key:"initCanvas",value:function(){var e=this,t=document.querySelector("canvas");t.width=this.width,t.height=this.height,this.cx=this.width/2,this.cy=this.height/2;var n=(this.canvas=t).getContext("2d");this.ctx=n,this.resizeCanvas(),window.addEventListener("resize",(0,a.throttle)(500,function(){e.setDimensions(),e.resizeCanvas()}))}},{key:"resizeCanvas",value:function(){this.canvas.width=this.width,this.canvas.height=this.height,this.cx=this.width/2,this.cy=this.height/2,this.ctx.imageSmoothingEnabled=!1}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.width,this.height)}}]),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=n(4),r=u(n(15)),o=u(n(1)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.isMouseDown=!1,this.lastPosition=null,this.position=null,this.pressedKeys=[],this.debounceValue=10,this.callbacks=r.default.callbacks}return i(t,[{key:"addCallback",value:function(e,t){var n=(0,o.default)();return this.callbacks[e].push({uuid:n,callBack:t}),n}},{key:"clearCallbacks",value:function(){this.callbacks=r.default.callbacks}},{key:"removeCallback",value:function(t){var n=this;Object.keys(this.callbacks).forEach(function(e){n.callbacks[e]=n.callbacks[e].filter(function(e){return e.uuid!==t})})}},{key:"init",value:function(){var t=this;document.addEventListener("mousemove",(0,a.throttle)(this.debounceValue,function(e){return t.handleMouseMove(e)})),document.addEventListener("mousedown",function(e){return t.handleMouseDown(e)}),document.addEventListener("mouseup",function(e){return t.handleMouseUp(e)}),document.addEventListener("touchmove",(0,a.throttle)(this.debounceValue,function(e){return t.handleTouchMove(e)})),document.addEventListener("touchstart",function(e){return t.handleTouchStart(e)}),document.addEventListener("touchend",function(e){return t.handleTouchEnd(e)}),document.onkeydown=this.handleKeyDown.bind(this),document.onkeyup=this.handleKeyUp.bind(this)}},{key:"handleTouchStart",value:function(t){this.lastPosition=this.position,this.isMouseDown=!0,this.callbacks.touchStart.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleTouchEnd",value:function(t){this.lastPosition=this.position,this.isMouseDown=!1,this.callbacks.touchEnd.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleTouchMove",value:function(t){t.preventDefault(),this.setPosition(t),this.callbacks.touchMove.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleMouseDown",value:function(t){this.lastPosition=this.position,this.isMouseDown=!0,this.callbacks.mouseDown.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleMouseUp",value:function(t){this.lastPosition=this.position,this.isMouseDown=!1,this.callbacks.mouseUp.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleMouseMove",value:function(t){this.setPosition(t),this.callbacks.mouseMove.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleKeyDown",value:function(t){this.pressedKeys.includes(t.keyCode)||this.pressedKeys.push(t.keyCode),this.callbacks.keyDown.forEach(function(e){return(0,e.callBack)(t)})}},{key:"handleKeyUp",value:function(t){var e=this.pressedKeys.indexOf(t.keyCode);-1<e&&this.pressedKeys.splice(e,1),this.callbacks.keyUp.forEach(function(e){return(0,e.callBack)(t)})}},{key:"setPosition",value:function(e){"clientX"in e&&(this.position=new s.default(e.clientX*this.GameState.Canvas.scale,e.clientY*this.GameState.Canvas.scale)),"targetTouches"in e&&(this.position=new s.default(e.targetTouches[0].clientX*this.GameState.Canvas.scale,e.targetTouches[0].clientY*this.GameState.Canvas.scale))}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={callbacks:{mouseDown:[],mouseUp:[],mouseMove:[],touchStart:[],touchEnd:[],touchMove:[],keyDown:[],keyUp:[]}}},function(e,t,n){"use strict";var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var a=new Uint8Array(16);e.exports=function(){return i(a),a}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t,n){"use strict";for(var a=[],i=0;i<256;++i)a[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,i=a;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=s(n(19)),r=s(n(5)),o=s(n(20));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.deltaTime=a.default.deltaTime,this.isPaused=a.default.isPaused,this.level=a.default.level,this.levels=a.default.levels,this.score=a.default.score,this.playerName=a.default.playerName,this.currentLevel=new r.default({GameState:this})}return i(e,[{key:"init",value:function(){this.initLevels()}},{key:"initLevels",value:function(){var t=this;this.levels=o.default.map(function(e){return new e({GameState:t})})}},{key:"loadLevel",value:function(){var e=this.levels[this.level];e.load(),this.currentLevel=e,document.activeElement.blur()}},{key:"play",value:function(){this.isPaused=!1,this.loadLevel()}},{key:"restart",value:function(){this.endlevel(),this.play()}},{key:"quit",value:function(){this.endlevel(),this.UI.setScreen("mainmenu")}},{key:"togglePause",value:function(){this.isPaused=!this.isPaused,this.isPaused&&this.Audio.audioContext.resume(),this.isPaused||this.Audio.audioContext.suspend()}},{key:"endlevel",value:function(){this.currentLevel.unload(),this.isPaused=!0,this.score=a.default.score}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={deltaTime:1,isPaused:!0,level:0,levels:[],playerName:"Player 1",score:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(21),r=(i=a)&&i.__esModule?i:{default:i};t.default=[r.default]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=v(n(22)),a=v(n(7)),o=v(n(23)),s=v(n(25)),u=v(n(26)),l=v(n(27)),c=v(n(28)),f=v(n(5)),h=v(n(30)),d=(v(n(10)),v(n(3)),v(n(2)),v(n(1))),y=v(n(0)),p=v(n(31));function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.name="Prototype Level",t.rows=6,t.columns=6,t.currentPlayerTurn=0,t.selectedTile=null,t.currentAction=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,f.default),i(n,[{key:"load",value:function(){var a=this;this.GameState.Scene.clear(),this.deck=new u.default({deckSize:this.rows*this.columns}),this.players=[new h.default({GameState:this.GameState,name:"Player 1",uuid:(0,d.default)(),color:"blue",avatar:new o.default({GameState:this.GameState,dimensions:new y.default(64,64),scale:new y.default(2,2),offset:new y.default(.5,.5),sprite:"./img/Avatar_Test.png"})}),new h.default({GameState:this.GameState,name:"Player 2",uuid:(0,d.default)(),color:"red",avatar:new o.default({GameState:this.GameState,dimensions:new y.default(64,64),scale:new y.default(2,2),offset:new y.default(.5,.5),sprite:"./img/Avatar_Test_2.png"})})],this.players.forEach(function(e,t){for(var n=new c.default({GameState:a.GameState,position:new y.default(0,-a.GameState.Canvas.cy)}),i=0;i<e.handSize;i++)n.add(a.deck.draw());n.setVisibility(!1),t===a.currentPlayerTurn&&n.setVisibility(!0),e.hand=n,a.GameState.Scene.add(n)}),this.grid=new l.default({GameState:this.GameState,rows:this.rows,columns:this.columns,minimumPadding:100,players:this.players}),this.grid.init(),this.currentAction=new r.default({player:this.players[this.currentPlayerTurn]}),this.addControlsCallback("mouseDown",this.handleMouseDown.bind(this)),this.addControlsCallback("mouseUp",this.handleMouseUp.bind(this)),this.addControlsCallback("mouseMove",this.handleMouseMove.bind(this))}},{key:"handleMouseDown",value:function(e){var t=this.findTileAtPosition(this.GameState.Controls.position);t&&this.selectTile(t)}},{key:"handleMouseUp",value:function(e){var t=this.findTileAtPosition(this.GameState.Controls.position);t&&("EMPTY"===(this.currentAction.targetTile=t).tileType.type&&this.selectedTile.isInHand&&(this.currentAction.actionType=new a.default("PLACE"),this.currentAction.commit(),this.cycleActions()),"PLAYER_COLUMN"===t.tileType.type&&"PLAYER_COLUMN"===this.selectedTile.tileType.type&&t.uuid!==this.selectedTile.uuid&&(this.currentAction.actionType=new a.default("MOVE"),this.currentAction.commit(),this.cycleActions()),"PLAYER_COLUMN"!==t.tileType.type&&"EMPTY"!==t.tileType.type&&t.uuid===this.selectedTile.uuid&&(this.currentAction.actionType=new a.default("ROTATE"),this.currentAction.commit(),t.isInHand||this.cycleActions()),this.deselectTile())}},{key:"handleMouseMove",value:function(e){this.previewTile&&(this.previewTile.canvasPosition=this.GameState.Controls.position)}},{key:"findTileAtPosition",value:function(e){var t=this.grid.getCellAtCanvasPosition(e);return t||(t=this.players[this.currentPlayerTurn].hand.getCellAtCanvasPosition(e)),t}},{key:"deselectTile",value:function(){this.previewTile&&this.GameState.Scene.remove(this.previewTile.uuid),this.selectedTile=null,this.lastSelectedTile=null,this.previewTile=null}},{key:"selectTile",value:function(e){this.selectedTile=e,this.currentAction.sourceTile=this.selectedTile,(e.isInHand||"PLAYER_COLUMN"===e.tileType.type)&&(this.previewTile=(0,s.default)(e),this.previewTile.alpha=.75,this.GameState.Scene.add(this.previewTile))}},{key:"cycleActions",value:function(){this.processConnection(),this.players[this.currentPlayerTurn].actions-=1,this.players[this.currentPlayerTurn].actions<=0&&(this.players[this.currentPlayerTurn].actions=this.players[this.currentPlayerTurn].maxActions,this.cyclePlayerTurn()),this.currentAction=new r.default({player:this.players[this.currentPlayerTurn]}),this.GameState.UI.updatePlayerStats(this.players)}},{key:"cyclePlayerTurn",value:function(){this.players[this.currentPlayerTurn].hand.setVisibility(!1),this.currentPlayerTurn++,this.currentPlayerTurn>=this.players.length&&(this.currentPlayerTurn=0),this.players[this.currentPlayerTurn].hand.setVisibility(!0),0<this.deck.tiles.length&&this.players[this.currentPlayerTurn].hand.add(this.deck.draw())}},{key:"processConnection",value:function(){var t=this,n=this.grid.tiles.find(function(e){return e.player&&e.player.name===t.players[t.currentPlayerTurn].name}),e=this.grid.tiles.find(function(e){return e.player&&e.player.name!==t.players[t.currentPlayerTurn].name}),i=new p.default(this.grid.tiles).findPath(n,e);if(0<i.length){var a=0;i.forEach(function(e){e.currentFrame=0,e.placedBy.name===n.player.name&&(a+=1)}),e.player.health-=n.player.damage+a}}}]),n}();t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(7),c=(i=r)&&i.__esModule?i:{default:i};var o=function(){function l(e){var t=e.type,n=void 0===t?new c.default("ROTATE"):t,i=e.targetTile,a=void 0===i?null:i,r=e.sourceTile,o=void 0===r?null:r,s=e.player,u=void 0===s?null:s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.actionType=n,this.targetTile=a,this.sourceTile=o,this.player=u}return a(l,[{key:"rotate",value:function(){this.targetTile.rotateCell(1),this.targetTile.placedBy=this.player}},{key:"place",value:function(){this.targetTile.setType(this.sourceTile.tileType),this.targetTile.rotation=this.sourceTile.rotation,this.targetTile.neighborPattern=this.sourceTile.neighborPattern,this.targetTile.neighbors=this.targetTile.getNeighbors(),this.targetTile.placedBy=this.player,this.player.hand.remove(this.sourceTile.uuid)}},{key:"move",value:function(){this.targetTile.player=this.sourceTile.player,this.sourceTile.player=null,this.targetTile.player.setAvatarPosition(this.targetTile)}},{key:"commit",value:function(){switch(this.actionType.type){case"MOVE":this.move();break;case"PLACE":this.place();break;case"ROTATE":this.rotate()}}}]),l}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(8));i(n(0));function i(e){return e&&e.__esModule?e:{default:e}}var r=function(e){function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e)),n=e.sprite;return t.animations={exist:{frames:1,spriteSheet:n,ticksPerFrame:10}},t.currentAnimation="exist",t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,a.default),i}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(0),r=(i=a)&&i.__esModule?i:{default:i};t.default=function(e,t){return new r.default(t.x+e.Canvas.width/2,e.Canvas.height-(t.y+e.Canvas.height/2))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=n(2),o=(i=a)&&i.__esModule?i:{default:i};var s=function(){function a(e){var t=e.deckSize,n=void 0===t?30:t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.tiles=[],this.tilesPerType=Math.floor(n/4),this.typeCounter=0,this.currentType=0,this.allowedTypes=["STRAIGHT","BEND","TRIPLE","QUAD"];for(var i=0;i<n;i++)this.tiles.push(new o.default(this.allowedTypes[this.currentType])),this.incrementType();this.shuffle()}return r(a,[{key:"incrementType",value:function(){this.typeCounter++,this.typeCounter>=this.tilesPerType&&(this.typeCounter=0,this.currentType+=1,this.currentType>=this.allowedTypes.length&&(this.currentType=0))}},{key:"shuffle",value:function(){for(var e=this.tiles.length-1;0<e;e--){var t=Math.floor(Math.random()*(e+1)),n=[this.tiles[t],this.tiles[e]];this.tiles[e]=n[0],this.tiles[t]=n[1]}}},{key:"draw",value:function(){return this.tiles.pop()}}]),a}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=u(n(10)),a=u(n(3)),o=u(n(2)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function l(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var t=e.GameState,n=e.rows,i=void 0===n?6:n,a=e.columns,r=void 0===a?6:a,o=e.minimumPadding,s=void 0===o?50:o,u=e.players;this.GameState=t,this.rows=i,this.columns=r+2,this.maxRowsOrColumns=Math.max(this.rows,this.columns),this.minimumPadding=s,this.tiles=[],this.players=u}return i(l,[{key:"init",value:function(){var a=this;this.minDimension=Math.min(this.GameState.Canvas.width,this.GameState.Canvas.height),this.cellSize=(this.minDimension-this.minimumPadding)/this.maxRowsOrColumns,this.padding=new s.default((this.GameState.Canvas.width-this.cellSize*this.columns)/2,(this.GameState.Canvas.height-this.cellSize*this.rows)/2);for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++){var n=new o.default("EMPTY");0!==t&&t!==this.columns-1||(n=new o.default("PLAYER_COLUMN")),this.addCell(t,e,n)}this.players.forEach(function(e,t){var n=(0===t?0:a.columns-1)+"_"+Math.floor((0,r.default)(0,a.rows-1)),i=a.tiles.find(function(e){return e.id===n});(i.player=e).setAvatarPosition(i)}),this.tiles.forEach(function(e){e.init(a.tiles)}),this.players.forEach(function(e){e.setAvatarPosition(e.avatar,e.avatar.x,e.avatar.y),a.GameState.Scene.add(e.avatar)})}},{key:"addCell",value:function(e,t,n){var i=new a.default({GameState:this.GameState,dimensions:new s.default(64,64),offset:new s.default(.5,.5),scale:new s.default(this.cellSize/64,this.cellSize/64),id:e+"_"+t,x:e,y:t,type:n});i.canvasPosition=new s.default(e*this.cellSize+this.padding.x+this.cellSize/2,t*this.cellSize+this.padding.y+this.cellSize/2),this.GameState.Scene.add(i),this.tiles.push(i)}},{key:"getCellAtCanvasPosition",value:function(e){var t=Math.floor((e.x-this.padding.x)/this.cellSize),n=Math.floor((e.y-this.padding.y)/this.cellSize);return this.tiles.find(function(e){return e.id===t+"_"+n})}}]),l}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=l(n(9)),r=l(n(29)),o=l(n(3)),s=l(n(1)),u=l(n(0));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.tiles=[],t.selectedTile=0,t.size=64,t.scale=2,t.paddingRatio=.2,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a.default),i(n,[{key:"add",value:function(e){var t=new o.default({GameState:this.GameState,dimensions:new u.default(this.size,this.size),offset:new u.default(.5,.5),scale:new u.default(this.scale,this.scale),type:e,isVisible:!1,isInHand:!0});t.uuid=(0,s.default)(),this.tiles.push(t),this.updatePosition()}},{key:"remove",value:function(t){this.tiles=this.tiles.filter(function(e){return e.uuid!==t}),this.updatePosition()}},{key:"updatePosition",value:function(){var n=this,i=this.tiles.length*this.size*this.scale/2;this.tiles.forEach(function(e,t){e.canvasPosition=new u.default(n.GameState.Canvas.cx+t*n.size*(n.scale+n.paddingRatio)-i,n.GameState.Canvas.height-n.size*n.scale/2)})}},{key:"load",value:function(){this.tiles.forEach(function(e){e.load()})}},{key:"drawEntity",value:function(){this.tiles.forEach(function(e){e.drawEntity()})}},{key:"setVisibility",value:function(t){this.tiles.forEach(function(e){e.isVisible=t})}},{key:"getCellAtCanvasPosition",value:function(t){return this.tiles.find(function(e){return(0,r.default)(t,new u.default(e.canvasPosition.x+e.absoluteOffset.x,e.canvasPosition.y+e.absoluteOffset.y),new u.default(e.dimensions.x*e.scale.x,e.dimensions.y*e.scale.y))})}}]),n}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return t.x<=e.x&&e.x<=t.x+n.x&&t.y<=e.y&&e.y<=t.y+n.y}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function S(e){var t=e.GameState,n=e.actions,i=void 0===n?2:n,a=e.avatar,r=e.color,o=void 0===r?"blue":r,s=e.controller,u=void 0===s?"human":s,l=e.damage,c=void 0===l?0:l,f=e.hand,h=void 0===f?[]:f,d=e.handSize,y=void 0===d?4:d,p=e.health,v=void 0===p?20:p,m=e.maxActions,b=void 0===m?2:m,g=e.maxHealth,w=void 0===g?20:g,P=e.name,k=void 0===P?"Player 1":P;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S),this.GameState=t,this.actions=i,this.avatar=a,this.color=o,this.controller=u,this.damage=c,this.hand=h,this.handSize=y,this.health=v,this.maxActions=b,this.maxHealth=w,this.name=k}return i(S,[{key:"setAvatarPosition",value:function(e){this.avatar.canvasPosition=e.canvasPosition,this.avatar.calculateOffset()}}]),S}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(32),o=(i=r)&&i.__esModule?i:{default:i};var s=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.grid=e,this.startCell=null,this.endCell=null,this.frontier=new o.default,this.pathFound=!1,this.hasSearched={},this.grid.forEach(function(e){delete e.cameFrom})}return a(t,[{key:"findPath",value:function(e,t){this.startCell=e,this.endCell=t,this.hasSearched[e.id]=!0,this.frontier.enqueue(e,1);for(var n=0;!this.pathFound&&0<this.frontier.items.length&&!(100<++n);)for(var i=0;i<this.frontier.items.length;i++)this.getFrontier();return this.buildPath()}},{key:"isPassable",value:function(e){return("PLAYER_COLUMN"!==e.tileType.type||e.player)&&"EMPTY"!==e.tileType.type}},{key:"isConnected",value:function(t,e){return e.neighbors.find(function(e){return!!e&&e.uuid===t.uuid})}},{key:"getFrontier",value:function(){var t=this,n=this.frontier.dequeue();n.neighbors.forEach(function(e){e&&(e.uuid===t.endCell.uuid&&(t.pathFound=!0),!t.hasSearched[e.id]&&t.isPassable(e)&&t.isConnected(n,e)&&(t.hasSearched[e.id]=!0,e.cameFrom=n,t.frontier.enqueue(e,1)))})}},{key:"buildPath",value:function(){for(var e=[this.endCell],t=0;!(100<++t);){var n=e[e.length-1].cameFrom;if(!n)break;e.push(n)}return this.pathFound?e:[]}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=[]}return i(e,[{key:"enqueue",value:function(e,t){for(var n=!1,i=0;i<this.items.length;i++)if(this.items[i].priority>e.priority){this.items.splice(i,0,e),n=!0;break}n||this.items.push(e)}},{key:"dequeue",value:function(){if(0!=this.items.length)return this.items.shift()}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.isRunning=!1}return i(t,[{key:"init",value:function(){this.isRunning||(this.isRunning=!0,this.render())}},{key:"shouldRender",value:function(){return!this.GameState.isPaused}},{key:"render",value:function(){this.isRunning&&window.requestAnimationFrame(this.render.bind(this)),this.shouldRender()&&(this.GameState.Canvas.clear(),this.GameState.Scene.gameObjects.forEach(function(e){return e.drawEntity()}))}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(1),o=(i=r)&&i.__esModule?i:{default:i};var s=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.gameObjects=[]}return a(t,[{key:"init",value:function(){}},{key:"add",value:function(e){return e.uuid=(0,o.default)(),e.load(),this.gameObjects.push(e),e.uuid}},{key:"remove",value:function(t){this.gameObjects.find(function(e){return e.uuid===t}).unload(),this.gameObjects=this.gameObjects.filter(function(e){return e.uuid!==t})}},{key:"clear",value:function(){this.gameObjects=[]}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.screens=document.querySelectorAll("[data-screen]"),this.buttons={fullscreen:document.querySelectorAll("[data-gamestate-fullscreen]"),initAudio:document.querySelectorAll("[data-gamestate-init-audio]"),level:document.querySelectorAll("[data-gamestate-change-level]"),mute:document.querySelectorAll("[data-gamestate-mute]"),pause:document.querySelectorAll("[data-gamestate-pause]"),play:document.querySelectorAll("[data-gamestate-play]"),quit:document.querySelectorAll("[data-gamestate-quit]"),restart:document.querySelectorAll("[data-gamestate-restart]"),screens:document.querySelectorAll("[data-ui-target-screen]")},this.isFullscreen=!1}return i(t,[{key:"init",value:function(){this.initListenters(),this.setScreen("mainmenu"),this.updateLevel(this.GameState.levels[this.GameState.level].name)}},{key:"initListenters",value:function(){var t=this;Array.from(this.buttons.initAudio).forEach(function(e){e.addEventListener("click",function(){t.GameState.Audio.isInitialized||t.GameState.Audio.init()})}),Array.from(this.buttons.play).forEach(function(e){e.addEventListener("click",function(){return t.GameState.play()})}),Array.from(this.buttons.pause).forEach(function(e){e.addEventListener("click",function(){return t.GameState.togglePause()})}),Array.from(this.buttons.restart).forEach(function(e){e.addEventListener("click",function(){return t.GameState.restart()})}),Array.from(this.buttons.fullscreen).forEach(function(e){e.addEventListener("click",function(){return t.toggleFullscreen()})}),Array.from(this.buttons.level).forEach(function(e){e.addEventListener("click",function(e){t.GameState.level+=parseInt(e.target.dataset.gamestateChangeLevel,10),t.GameState.level>=t.GameState.levels.length&&(t.GameState.level=0),t.GameState.level<0&&(t.GameState.level=t.GameState.levels.length-1),t.updateLevel(t.GameState.levels[t.GameState.level].name)})}),Array.from(this.buttons.quit).forEach(function(e){e.addEventListener("click",function(){return t.GameState.quit()})}),Array.from(this.buttons.mute).forEach(function(e){e.addEventListener("click",function(e){return t.GameState.Audio.toggleMute()})}),Array.from(this.buttons.screens).forEach(function(e){e.addEventListener("click",t.initTransitions.bind(t))})}},{key:"initTransitions",value:function(e){this.setScreen(e.target.dataset.uiTargetScreen)}},{key:"setScreen",value:function(t){Array.from(this.screens).forEach(function(e){e.dataset.screen===t?e.classList.add("active"):e.classList.remove("active")})}},{key:"toggleFullscreen",value:function(){var e=document.documentElement;this.isFullscreen||(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()),this.isFullscreen&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()),this.isFullscreen=!this.isFullscreen}},{key:"updatePlayerStats",value:function(e){var o=this;e&&e.forEach(function(e,t){var n=document.querySelector('[data-ui-player="'+(t+1)+'"] [data-ui="name"]'),i=document.querySelector('[data-ui-player="'+(t+1)+'"] [data-ui="health"]'),a=document.querySelector('[data-ui-player="'+(t+1)+'"] [data-ui="damage"]'),r=document.querySelector('[data-ui-player="'+(t+1)+'"] [data-ui="actions"]');n.innerHTML=e.name+(o.GameState.currentLevel.currentPlayerTurn===t?"*":""),i.innerHTML="HP: "+e.health+"/"+e.maxHealth,a.innerHTML="DMG: "+e.damage,r.innerHTML="ACT: "+e.actions+"/"+e.maxActions})}},{key:"updateLevel",value:function(t){t&&Array.from(document.querySelectorAll('[data-ui="level"]')).forEach(function(e){e.innerHTML=t})}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.isRunning=!1,this.lastUpdate=Date.now(),this.updateRate=10}return i(t,[{key:"init",value:function(){this.isRunning||(this.isRunning=!0,this.update())}},{key:"calculateDeltaTime",value:function(){var e=Date.now();this.GameState.deltaTime=e-this.lastUpdate,this.lastUpdate=e}},{key:"shouldUpdate",value:function(){return!this.GameState.isPaused}},{key:"update",value:function(){this.isRunning&&window.setTimeout(this.update.bind(this),this.updateRate),this.shouldUpdate()&&(this.calculateDeltaTime(),this.GameState.levels[this.GameState.level].gameLogic(),this.GameState.Scene.gameObjects.forEach(function(e){return e.update()}))}}]),t}();t.default=a}])});